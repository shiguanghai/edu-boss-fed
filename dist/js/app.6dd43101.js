(function (e) { function t (t) { for (var r, o, u = t[0], s = t[1], i = t[2], l = 0, d = []; l < u.length; l++)o = u[l], Object.prototype.hasOwnProperty.call(a, o) && a[o] && d.push(a[o][0]), a[o] = 0; for (r in s)Object.prototype.hasOwnProperty.call(s, r) && (e[r] = s[r]); f && f(t); while (d.length)d.shift()(); return c.push.apply(c, i || []), n() } function n () { for (var e, t = 0; t < c.length; t++) { for (var n = c[t], r = !0, o = 1; o < n.length; o++) { var u = n[o]; a[u] !== 0 && (r = !1) }r && (c.splice(t--, 1), e = s(s.s = n[0])) } return e } var r = {}; var o = { app: 0 }; var a = { app: 0 }; var c = []; function u (e) { return s.p + 'js/' + ({ 404: '404', advert: 'advert', 'advert-space': 'advert-space', 'alloc-menu': 'alloc-menu', course: 'course', 'course-create~course-edit': 'course-create~course-edit', 'course-create': 'course-create', 'course-edit': 'course-edit', 'course-section': 'course-section', 'course-video': 'course-video', home: 'home', login: 'login', menu: 'menu', 'menu-create-edit': 'menu-create-edit', resource: 'resource', role: 'role', user: 'user' }[e] || e) + '.' + { 404: '4f747c41', advert: '62837371', 'advert-space': 'e72fc61e', 'alloc-menu': '80c62458', course: '6c697491', 'course-create~course-edit': 'c3936268', 'course-create': 'ac8a8252', 'course-edit': '904f5411', 'course-section': '36e1feb3', 'course-video': 'd9c298ee', home: '21bc32e1', login: '8ff5e96b', menu: 'bd9f3d9a', 'menu-create-edit': '49228d42', resource: 'b0e6c395', role: '4638ad1e', user: '23a3503c' }[e] + '.js' } function s (t) { if (r[t]) return r[t].exports; var n = r[t] = { i: t, l: !1, exports: {} }; return e[t].call(n.exports, n, n.exports, s), n.l = !0, n.exports }s.e = function (e) { var t = []; var n = { course: 1, 'course-create~course-edit': 1, 'course-section': 1, login: 1, menu: 1, resource: 1, role: 1, user: 1 }; o[e] ? t.push(o[e]) : o[e] !== 0 && n[e] && t.push(o[e] = new Promise(function (t, n) { for (var r = 'css/' + ({ 404: '404', advert: 'advert', 'advert-space': 'advert-space', 'alloc-menu': 'alloc-menu', course: 'course', 'course-create~course-edit': 'course-create~course-edit', 'course-create': 'course-create', 'course-edit': 'course-edit', 'course-section': 'course-section', 'course-video': 'course-video', home: 'home', login: 'login', menu: 'menu', 'menu-create-edit': 'menu-create-edit', resource: 'resource', role: 'role', user: 'user' }[e] || e) + '.' + { 404: '31d6cfe0', advert: '31d6cfe0', 'advert-space': '31d6cfe0', 'alloc-menu': '31d6cfe0', course: 'cf153bb6', 'course-create~course-edit': '91df8e3a', 'course-create': '31d6cfe0', 'course-edit': '31d6cfe0', 'course-section': '9b607887', 'course-video': '31d6cfe0', home: '31d6cfe0', login: 'f7fe7851', menu: '3949e929', 'menu-create-edit': '31d6cfe0', resource: '00ce15b5', role: '6ccc9600', user: '1f2ebad3' }[e] + '.css', a = s.p + r, c = document.getElementsByTagName('link'), u = 0; u < c.length; u++) { var i = c[u]; var l = i.getAttribute('data-href') || i.getAttribute('href'); if (i.rel === 'stylesheet' && (l === r || l === a)) return t() } var d = document.getElementsByTagName('style'); for (u = 0; u < d.length; u++) { i = d[u], l = i.getAttribute('data-href'); if (l === r || l === a) return t() } var f = document.createElement('link'); f.rel = 'stylesheet', f.type = 'text/css', f.onload = t, f.onerror = function (t) { var r = t && t.target && t.target.src || a; var c = new Error('Loading CSS chunk ' + e + ' failed.\n(' + r + ')'); c.code = 'CSS_CHUNK_LOAD_FAILED', c.request = r, delete o[e], f.parentNode.removeChild(f), n(c) }, f.href = a; var m = document.getElementsByTagName('head')[0]; m.appendChild(f) }).then(function () { o[e] = 0 })); var r = a[e]; if (r !== 0) if (r)t.push(r[2]); else { var c = new Promise(function (t, n) { r = a[e] = [t, n] }); t.push(r[2] = c); var i; var l = document.createElement('script'); l.charset = 'utf-8', l.timeout = 120, s.nc && l.setAttribute('nonce', s.nc), l.src = u(e); var d = new Error(); i = function (t) { l.onerror = l.onload = null, clearTimeout(f); var n = a[e]; if (n !== 0) { if (n) { var r = t && (t.type === 'load' ? 'missing' : t.type); var o = t && t.target && t.target.src; d.message = 'Loading chunk ' + e + ' failed.\n(' + r + ': ' + o + ')', d.name = 'ChunkLoadError', d.type = r, d.request = o, n[1](d) }a[e] = void 0 } }; var f = setTimeout(function () { i({ type: 'timeout', target: l }) }, 12e4); l.onerror = l.onload = i, document.head.appendChild(l) } return Promise.all(t) }, s.m = e, s.c = r, s.d = function (e, t, n) { s.o(e, t) || Object.defineProperty(e, t, { enumerable: !0, get: n }) }, s.r = function (e) { typeof Symbol !== 'undefined' && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, { value: 'Module' }), Object.defineProperty(e, '__esModule', { value: !0 }) }, s.t = function (e, t) { if (1 & t && (e = s(e)), 8 & t) return e; if (4 & t && typeof e === 'object' && e && e.__esModule) return e; var n = Object.create(null); if (s.r(n), Object.defineProperty(n, 'default', { enumerable: !0, value: e }), 2 & t && typeof e !== 'string') for (var r in e)s.d(n, r, function (t) { return e[t] }.bind(null, r)); return n }, s.n = function (e) { var t = e && e.__esModule ? function () { return e.default } : function () { return e }; return s.d(t, 'a', t), t }, s.o = function (e, t) { return Object.prototype.hasOwnProperty.call(e, t) }, s.p = '/', s.oe = function (e) { throw console.error(e), e }; var i = window.webpackJsonp = window.webpackJsonp || []; var l = i.push.bind(i); i.push = t, i = i.slice(); for (var d = 0; d < i.length; d++)t(i[d]); var f = l; c.push([0, 'chunk-vendors']), n() })({ 0: function (e, t, n) { e.exports = n('cd49') }, '0613': function (e, t, n) { 'use strict'; var r = n('2b0e'); var o = n('2f62'); r.default.use(o.a), t.a = new o.a.Store({ state: { user: JSON.parse(window.localStorage.getItem('user') || 'null') }, mutations: { setUser: function (e, t) { e.user = JSON.parse(t), window.localStorage.setItem('user', t) } }, actions: {}, modules: {} }) }, '06a0': function (e, t, n) { 'use strict'; n.d(t, 'd', function () { return c }), n.d(t, 'b', function () { return u }), n.d(t, 'c', function () { return s }), n.d(t, 'a', function () { return i }); var r = n('b32d'); var o = n('4328'); var a = n.n(o); var c = function (e) { return Object(r.a)({ method: 'POST', url: '/front/user/login', data: a.a.stringify(e) }) }; var u = function () { return Object(r.a)({ method: 'GET', url: '/front/user/getInfo' }) }; var s = function (e) { return Object(r.a)({ method: 'POST', url: '/boss/user/getUserPages', data: e }) }; var i = function (e) { return Object(r.a)({ method: 'POST', url: '/boss/user/forbidUser', params: { userId: e } }) } }, 1: function (e, t) {}, 3402: function (e, t, n) { 'use strict'; n('88af') }, '5bd9': function (e, t, n) { 'use strict'; n('d022') }, '88af': function (e, t, n) {}, afbc: function (e, t, n) { 'use strict'; n('d3b7'), n('3ca3'), n('ddb0'); var r = n('2b0e'); var o = n('8c4f'); var a = function () { var e = this; var t = e.$createElement; var n = e._self._c || t; return n('el-container', [n('el-aside', { attrs: { width: '200px' } }, [n('app-aside')], 1), n('el-container', [n('el-header', [n('app-header')], 1), n('el-main', [n('router-view')], 1)], 1)], 1) }; var c = []; var u = function () { var e = this; var t = e.$createElement; var n = e._self._c || t; return n('div', { staticClass: 'aside' }, [n('el-menu', { attrs: { 'default-active': '2', 'background-color': '#545c64', 'text-color': '#fff', 'active-text-color': '#ffd04b', router: '' }, on: { open: e.handleOpen, close: e.handleClose } }, [n('el-submenu', { attrs: { index: '1' } }, [n('template', { slot: 'title' }, [n('i', { staticClass: 'el-icon-location' }), n('span', [e._v('权限管理')])]), n('el-menu-item', { attrs: { index: '/role' } }, [n('i', { staticClass: 'el-icon-setting' }), n('span', { attrs: { slot: 'title' }, slot: 'title' }, [e._v('角色管理')])]), n('el-menu-item', { attrs: { index: '/menu' } }, [n('i', { staticClass: 'el-icon-setting' }), n('span', { attrs: { slot: 'title' }, slot: 'title' }, [e._v('菜单管理')])]), n('el-menu-item', { attrs: { index: '/resource' } }, [n('i', { staticClass: 'el-icon-setting' }), n('span', { attrs: { slot: 'title' }, slot: 'title' }, [e._v('资源管理')])])], 2), n('el-menu-item', { attrs: { index: '/course' } }, [n('i', { staticClass: 'el-icon-menu' }), n('span', { attrs: { slot: 'title' }, slot: 'title' }, [e._v('课程管理')])]), n('el-menu-item', { attrs: { index: '/user' } }, [n('i', { staticClass: 'el-icon-document' }), n('span', { attrs: { slot: 'title' }, slot: 'title' }, [e._v('用户管理')])]), n('el-submenu', { attrs: { index: '4' } }, [n('template', { slot: 'title' }, [n('i', { staticClass: 'el-icon-location' }), n('span', [e._v('广告管理')])]), n('el-menu-item', { attrs: { index: '/advert' } }, [n('i', { staticClass: 'el-icon-setting' }), n('span', { attrs: { slot: 'title' }, slot: 'title' }, [e._v('广告列表')])]), n('el-menu-item', { attrs: { index: '/advert-space' } }, [n('i', { staticClass: 'el-icon-setting' }), n('span', { attrs: { slot: 'title' }, slot: 'title' }, [e._v('广告位列表')])])], 2)], 1)], 1) }; var s = []; var i = r.default.extend({ name: 'AppAside', methods: { handleOpen: function (e, t) { console.log(e, t) }, handleClose: function (e, t) { console.log(e, t) } } }); var l = i; var d = (n('b0d8'), n('2877')); var f = Object(d.a)(l, u, s, !1, null, '47e2a16f', null); var m = f.exports; var p = function () { var e = this; var t = e.$createElement; var n = e._self._c || t; return n('div', { staticClass: 'header' }, [n('el-breadcrumb', { attrs: { 'separator-class': 'el-icon-arrow-right' } }, [n('el-breadcrumb-item', { attrs: { to: { path: '/' } } }, [e._v('首页')]), n('el-breadcrumb-item', [e._v('活动管理')]), n('el-breadcrumb-item', [e._v('活动列表')]), n('el-breadcrumb-item', [e._v('活动详情')])], 1), n('el-dropdown', [n('span', { staticClass: 'el-dropdown-link' }, [n('el-avatar', { attrs: { shape: 'square', size: 40, src: e.userInfo.portrait || 'https://public.shiguanghai.top/blog_img/default-avatarnUSD98.png' } }), n('i', { staticClass: 'el-icon-arrow-down el-icon--right' })], 1), n('el-dropdown-menu', { attrs: { slot: 'dropdown' }, slot: 'dropdown' }, [n('el-dropdown-item', [e._v(e._s(e.userInfo.userName))]), n('el-dropdown-item', { attrs: { divided: '' }, nativeOn: { click: function (t) { return e.handleLogout(t) } } }, [e._v('退出')])], 1)], 1)], 1) }; var h = []; var b = n('1da1'); var v = (n('96cf'), n('06a0')); var g = r.default.extend({ name: 'AppHeader', data: function () { return { userInfo: {} } }, created: function () { this.loadUserInfo() }, methods: { loadUserInfo: function () { var e = this; return Object(b.a)(regeneratorRuntime.mark(function t () { var n, r; return regeneratorRuntime.wrap(function (t) { while (1) switch (t.prev = t.next) { case 0:return t.next = 2, Object(v.b)(); case 2:n = t.sent, r = n.data, e.userInfo = r.content; case 5:case 'end':return t.stop() } }, t) }))() }, handleLogout: function () { var e = this; this.$confirm('确认退出?', '退出提示', { confirmButtonText: '确定', cancelButtonText: '取消', type: 'warning' }).then(function () { e.$store.commit('setUser', null), e.$router.push({ name: 'login' }), e.$message({ type: 'success', message: '退出成功!' }) }).catch(function () { e.$message({ type: 'info', message: '已取消退出' }) }) } } }); var w = g; var x = (n('3402'), Object(d.a)(w, p, h, !1, null, 'e11a190c', null)); var y = x.exports; var _ = r.default.extend({ name: 'LayoutIndex', components: { AppAside: m, AppHeader: y } }); var O = _; var j = (n('5bd9'), Object(d.a)(O, a, c, !1, null, '6be66b14', null)); var k = j.exports; var P = n('0613'); r.default.use(o.a); var C = [{ path: '/login', name: 'login', component: function () { return n.e('login').then(n.bind(null, '9ed6')) } }, { path: '/', component: k, meta: { requiresAuth: !0 }, children: [{ path: '', name: 'home', component: function () { return n.e('home').then(n.bind(null, '7abe')) } }, { path: '/role', name: 'role', component: function () { return n.e('role').then(n.bind(null, '6c35')) } }, { path: '/menu', name: 'menu', component: function () { return n.e('menu').then(n.bind(null, 'f833')) } }, { path: '/resource', name: 'resource', component: function () { return n.e('resource').then(n.bind(null, '2240')) } }, { path: '/course', name: 'course', component: function () { return n.e('course').then(n.bind(null, 'bff8')) } }, { path: '/user', name: 'user', component: function () { return n.e('user').then(n.bind(null, 'e382')) } }, { path: '/advert', name: 'advert', component: function () { return n.e('advert').then(n.bind(null, '46ad')) } }, { path: '/advert-space', name: 'advert-space', component: function () { return n.e('advert-space').then(n.bind(null, 'caea')) } }, { path: '/menu/create', name: 'menu-create', component: function () { return n.e('menu-create-edit').then(n.bind(null, 'ad8d')) } }, { path: '/menu/:id/edit', name: 'menu-edit', component: function () { return n.e('menu-create-edit').then(n.bind(null, 'f8a9')) } }, { path: '/role/:roleId/alloc-menu', name: 'alloc-menu', component: function () { return n.e('alloc-menu').then(n.bind(null, '7ca9')) }, props: !0 }, { path: '/role/:roleId/alloc-resource', name: 'alloc-resource', component: function () { return n.e('alloc-menu').then(n.bind(null, '9614')) }, props: !0 }, { path: '/course/create', name: 'course-create', component: function () { return Promise.all([n.e('course-create~course-edit'), n.e('course-create')]).then(n.bind(null, '808d')) } }, { path: '/course/:courseId/edit', name: 'course-edit', component: function () { return Promise.all([n.e('course-create~course-edit'), n.e('course-edit')]).then(n.bind(null, '8fa7')) }, props: !0 }, { path: '/course/:courseId/section', name: 'course-section', component: function () { return n.e('course-section').then(n.bind(null, '4614')) }, props: !0 }, { path: '/course/:courseId/video', name: 'course-video', component: function () { return n.e('course-video').then(n.bind(null, '1f26')) }, props: !0 }] }, { path: '*', name: '404', component: function () { return n.e('404').then(n.bind(null, '1db4')) } }]; var S = new o.a({ routes: C }); S.beforeEach(function (e, t, n) { e.matched.some(function (e) { return e.meta.requiresAuth }) ? P.a.state.user ? n() : n({ name: 'login', query: { redirect: e.fullPath } }) : n() }); t.a = S }, b0d8: function (e, t, n) { 'use strict'; n('bfef') }, b20f: function (e, t, n) {}, b32d: function (e, t, n) { 'use strict'; var r = n('1da1'); var o = (n('96cf'), n('d3b7'), n('159b'), n('bc3a')); var a = n.n(o); var c = n('0613'); var u = n('5c96'); var s = n('afbc'); var i = n('4328'); var l = n.n(i); var d = a.a.create({}); function f () { s.a.push({ name: 'login', query: { redirect: s.a.currentRoute.fullPath } }) } function m () { return a.a.create()({ method: 'POST', url: '/front/user/refresh_token', data: l.a.stringify({ refreshtoken: c.a.state.user.refresh_token }) }) }d.interceptors.request.use(function (e) { var t = c.a.state.user; return t && t.access_token && (e.headers.Authorization = t.access_token), e }, function (e) { return Promise.reject(e) }); var p = !1; var h = []; d.interceptors.response.use(function (e) { return e }, (function () { var e = Object(r.a)(regeneratorRuntime.mark(function e (t) { var n; return regeneratorRuntime.wrap(function (e) { while (1) switch (e.prev = e.next) { case 0:if (!t.response) { e.next = 19; break } if (n = t.response.status, n !== 400) { e.next = 6; break }u.Message.error('请求参数错误'), e.next = 17; break; case 6:if (n !== 401) { e.next = 16; break } if (c.a.state.user) { e.next = 10; break } return f(), e.abrupt('return', Promise.reject(t)); case 10:if (p) { e.next = 13; break } return p = !0, e.abrupt('return', m().then(function (e) { if (!e.data.success) throw new Error('刷新 Token 失败'); return c.a.commit('setUser', e.data.content), h.forEach(function (e) { return e() }), h = [], d(t.config) }).catch(function (e) { return console.log(e), c.a.commit('setUser', null), f(), Promise.reject(t) }).finally(function () { p = !1 })); case 13:return e.abrupt('return', new Promise(function (e) { h.push(function () { e(d(t.config)) }) })); case 16:n === 403 ? u.Message.error('没有权限，请联系管理员') : n === 404 ? u.Message.error('请求资源不存在') : n >= 500 && u.Message.error('服务端错误，请联系管理员'); case 17:e.next = 20; break; case 19:t.request ? u.Message.error('请求超时，请刷新重试') : u.Message.error('请求失败：'.concat(t.message)); case 20:return e.abrupt('return', Promise.reject(t)); case 21:case 'end':return e.stop() } }, e) })); return function (t) { return e.apply(this, arguments) } }())), t.a = d }, bfef: function (e, t, n) {}, cd49: function (e, t, n) { 'use strict'; n.r(t); n('e260'), n('e6cf'), n('cca6'), n('a79d'); var r = n('2b0e'); var o = function () { var e = this; var t = e.$createElement; var n = e._self._c || t; return n('div', { attrs: { id: 'app' } }, [n('router-view')], 1) }; var a = []; var c = r.default.extend({ name: 'App' }); var u = c; var s = n('2877'); var i = Object(s.a)(u, o, a, !1, null, '476b9d20', null); var l = i.exports; var d = n('afbc'); var f = n('0613'); var m = n('5c96'); var p = n.n(m); n('b20f'); r.default.use(p.a), r.default.config.productionTip = !1, new r.default({ router: d.a, store: f.a, render: function (e) { return e(l) } }).$mount('#app') }, d022: function (e, t, n) {} })
// # sourceMappingURL=app.6dd43101.js.map
